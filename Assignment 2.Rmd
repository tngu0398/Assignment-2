---
title: "Assignment 2"
authors: "Tony Nguyen, Jane Nguyen, Shiyuan Zhang, Naveed Aamir"
date: "2023-06-07"
output: html_document
---

```{r setup, include = FALSE}

# added libraries to potentially use 
library(ISLR)
library(MASS)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(gganimate)
library(ggrepel)
library(dplyr)
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata) 
library(knitr)
library(kableExtra)
library(countrycode)

knitr::opts_chunk$set(echo = TRUE)

```


```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# read in data set 
data = read.csv('Merge_all_2010_2020.csv')

```


```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# extracting columns to use from data 
extractedData =  data[, c(1, 2, 3, 13)]

# display head of data 
head(extractedData)

```


```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# get classes from extracted data  
extractedDataClass = names(extractedData)

extractedDataClasses = data.frame(Variables = extractedDataClass)

# display classes using kable()
kable(extractedDataClasses, format = "html", align = "c") %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)

```


```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# summary of extracted data 
summaryExtractData = summary(extractedData$Total.alcohol.consumption.per.capita..liters.of.pure.alcohol..projected.estimates..15..years.of.age..y)

summaryExtractDataArray = as.array(summaryExtractData)

summaryExtractedData = data.frame(Statistics = rownames(summaryExtractDataArray), Values = summaryExtractDataArray, stringsAsFactors = FALSE)

# NEED TO CHANGE COLUMN NAMES

kable(summaryExtractDataArray, format = "html", align = "c") %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)

```


---

**Figure 1** 

```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

worldMap = map_data("world")

extractedData2018 = filter(extractedData, Year == 2018)

worldMap $ iso3c = countrycode(worldMap$region, 'country.name', 'iso3c')

extractedData2018Map = left_join(worldMap, extractedData2018, by = c("iso3c" = "Code"))

dataMap = ggplot() + geom_map(data = extractedData2018Map, map = extractedData2018Map, aes(x = long, y = lat, map_id = region, fill = Total.alcohol.consumption.per.capita..liters.of.pure.alcohol..projected.estimates..15..years.of.age..y), color = "black") + coord_equal() + theme_void() + scale_fill_gradient2(low = "white", mid = "lightblue", high = "darkred", name = "Alcohol Consumed (Litres)") + labs(title = "2018 Alcohol Consumption per Capita")

dataMap

```


---

**Figure 2** 

```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

topCountryExtractedData2018 = extractedData2018 %>% group_by(Entity) %>% summarize(Total = sum(Total.alcohol.consumption.per.capita..liters.of.pure.alcohol..projected.estimates..15..years.of.age..y))

topCountryExtractedData2018 = arrange(topCountryExtractedData2018, desc(Total))

topCountryExtractedData2018 = head(topCountryExtractedData2018, 20)

top20Bar = ggplot(topCountryExtractedData2018, aes(x = Entity, y = Total, color = Entity)) + geom_bar(stat = "identity", fill = "white") + labs(title = "Top 20 Countries by Alcohol Consumption in 2018", x = "Countries", y = "Alcohol Consumed (Litres)") + theme_minimal() + scale_x_discrete(guide = guide_axis(angle = 30)) + theme(legend.position = "none")

top20Bar

```



