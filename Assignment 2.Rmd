---
title: "Assignment 2"
authors: "Tony Nguyen, Jane Nguyen, Shiyuan Zhang, Naveed Aamir"
date: "2023-06-07"
output: html_document
---

```{r setup, include = FALSE}

# added libraries to potentially use 
library(ISLR)
library(MASS)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(gganimate)
library(ggrepel)
library(dplyr)
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata) 
library(knitr)
library(kableExtra)
library(countrycode)

knitr::opts_chunk$set(echo = TRUE)

```


```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# read in data set 
data = read.csv('Merge_all_2010_2020_updated.csv')

```


```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# extracting columns to use from data 
extractedData =  data[, c(1, 2, 3, 12)]

# omit NA values
newExtractedData = na.omit(extractedData)

# head of data 
extractedDataHead = head(newExtractedData)

```

Research Questions:   
- How has the total alcohol consumption per capita changed over time in relation to geographical regions?        
- How does the influence of religion relate to variations in total alcohol consumption per capita across different countries?     

---

**Variable Class** 

```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# get classes from extracted data  
extractedDataClass = names(newExtractedData)

extractedDataClasses = data.frame(Variables = extractedDataClass)

# display classes using kable()
kable(extractedDataClasses, format = "html", align = "c") %>% kable_styling(bootstrap_options = c("striped", "hover"))

```


---

**Summary Table** 

```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE}

# 2000 data
y2000 = newExtractedData[newExtractedData $ Year == 2000, ]

year2000Total = summary(y2000 $ Total_alcohol_consumption_per_capita)

year2000TotalArray = as.array(year2000Total)

year2000TotalData = data.frame(Statistics = rownames(year2000TotalArray), Values = year2000TotalArray, stringsAsFactors = FALSE)


# 2005 data
y2005 = newExtractedData[newExtractedData $ Year == 2005, ]

year2005Total = summary(y2005 $ Total_alcohol_consumption_per_capita)

year2005TotalArray = as.array(year2005Total)

year2005TotalData = data.frame(Statistics = rownames(year2005TotalArray), Values = year2005TotalArray, stringsAsFactors = FALSE)


# 2010 data
y2010 = newExtractedData[newExtractedData $ Year == 2010, ]

year2010Total = summary(y2010 $ Total_alcohol_consumption_per_capita)

year2010TotalArray = as.array(year2010Total)

year2010TotalData = data.frame(Statistics = rownames(year2010TotalArray), Values = year2010TotalArray, stringsAsFactors = FALSE)


# 2015 data
y2015 = newExtractedData[newExtractedData $ Year == 2015, ]

year2015Total = summary(y2015 $ Total_alcohol_consumption_per_capita)

year2015TotalArray = as.array(year2015Total)

year2015TotalData = data.frame(Statistics = rownames(year2015TotalArray), Values = year2015TotalArray, stringsAsFactors = FALSE)


# 2018 data
y2018 = newExtractedData[newExtractedData $ Year == 2018, ]

year2018Total = summary(y2018 $ Total_alcohol_consumption_per_capita)

year2018TotalArray = as.array(year2018Total)

year2018TotalData = data.frame(Statistics = rownames(year2018TotalArray), Values = year2018TotalArray, stringsAsFactors = FALSE)


# combining columns 
totalCombinedSummary = cbind(year2000TotalData$Statistics, year2000TotalData$Values.Freq, year2005TotalData$Values.Freq, year2010TotalData$Values.Freq, year2015TotalData$Values.Freq, year2018TotalData$Values.Freq)

# renaming columns 
colnames(totalCombinedSummary) = c("Statistics", "2000", "2005", "2010", "2015", "2018")

# presenting using kable()
kable(totalCombinedSummary, format = "html", align = "c") %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)

```


---

**Figure 1**      

```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE, fig.width = 6, fig.height = 4}

# selecting specific regions 
specifiedRegions = c("World", "East Asia and Pacific", "Europe and Central Asia", "Latin America and Caribbean", "Middle East and North Africa", "North America", "South Asia", "Sub-Saharan Africa")

specifiedRegionsData = newExtractedData %>% filter(Entity %in% specifiedRegions)

# create chart with World being a dotdash line type 
regionChart = ggplot(specifiedRegionsData, aes(x = Year, y = Total_alcohol_consumption_per_capita, group = Entity, color = Entity)) + geom_line(aes(linetype= if_else(Entity == "World", "solid", "dotdash"))) + geom_point() + labs(x = "Year", y = "Alcohol Consumption in Litres", title = "Total Alcohol Consumption by Geographical Region") + scale_linetype_manual(values = c("solid", "dotdash"), guide = FALSE) + theme_minimal()

regionChart

```

The line chart presents the total alcohol consumption by geographical regions over the years (2000 to 2018). The dot-dashed line represents the World's average total alcohol consumption each year  

- There has been a significant decrease of total alcohol consumption from the 'Europe and Central Asia' region and an overall slight decrease from 'Latin America and Caribbean' and 'Sub-Saharan Africa' regions in this time period.     

- The regions 'East Asia and Pacific' and 'South Asia' both experienced rapid growth during this time frame but especially between 2005 and 2010. 

- While regions 'North America' and 'Middle East and North Africa' both slightly increased in total alcohol consumption from 2000 to 2018, the 'Middle East and North Africa' region is still the lowest overall, averaging less than 1L of alcohol consumed each year.     

From the data collected, we can see that there is an overall increase in alcohol consumption globally. However, there are regions that have significantly decreased in consumption, which can be related to an increase in modern research of how alcohol can be detrimental to health. Moreover, we can see that the region 'Middle East and North Africa' is the lowest region in alcohol consumption which may be attributed to the region's religious beliefs and values. 


---

**Figure 2**     

```{r, echo = FALSE, warning = FALSE, message = FALSE, error = FALSE, fig.width = 6, fig.height = 4}

# loading world map 
worldMap = map_data("world")

# selecting specific year 2000
extractedData2000 = filter(newExtractedData, Year == 2000)

worldMap $ iso3c = countrycode(worldMap$region, 'country.name', 'iso3c')

extractedData2000Map = left_join(worldMap, extractedData2000, by = c("iso3c" = "Code"))

# heat map based on total alcohol consumption in 2000 
dataMap2000 = ggplot() + geom_map(data = extractedData2000Map, map = extractedData2000Map, aes(x = long, y = lat, map_id = region, fill = Total_alcohol_consumption_per_capita), color = "black") + coord_equal() + theme_void() + scale_fill_gradient2(low = "white", mid = "lightblue", high = "darkred", name = "Alcohol Consumed (Litres)") + labs(title = "2000 Alcohol Consumption per Capita")


# selecting specific year 2005
extractedData2005 = filter(newExtractedData, Year == 2005)

extractedData2005Map = left_join(worldMap, extractedData2005, by = c("iso3c" = "Code"))

# heat map based on total alcohol consumption in 2005 
dataMap2005 = ggplot() + geom_map(data = extractedData2005Map, map = extractedData2005Map, aes(x = long, y = lat, map_id = region, fill = Total_alcohol_consumption_per_capita), color = "black") + coord_equal() + theme_void() + scale_fill_gradient2(low = "white", mid = "lightblue", high = "darkred", name = "Alcohol Consumed (Litres)") + labs(title = "2005 Alcohol Consumption per Capita")


# selecting specific year 2010
extractedData2010 = filter(newExtractedData, Year == 2010)

extractedData2010Map = left_join(worldMap, extractedData2010, by = c("iso3c" = "Code"))

# heat map based on total alcohol consumption in 2010 
dataMap2010 = ggplot() + geom_map(data = extractedData2010Map, map = extractedData2010Map, aes(x = long, y = lat, map_id = region, fill = Total_alcohol_consumption_per_capita), color = "black") + coord_equal() + theme_void() + scale_fill_gradient2(low = "white", mid = "lightblue", high = "darkred", name = "Alcohol Consumed (Litres)") + labs(title = "2010 Alcohol Consumption per Capita")


# selecting specific year 2015
extractedData2015 = filter(newExtractedData, Year == 2015)

extractedData2015Map = left_join(worldMap, extractedData2015, by = c("iso3c" = "Code"))

# heat map based on total alcohol consumption in 2015 
dataMap2015 = ggplot() + geom_map(data = extractedData2015Map, map = extractedData2015Map, aes(x = long, y = lat, map_id = region, fill = Total_alcohol_consumption_per_capita), color = "black") + coord_equal() + theme_void() + scale_fill_gradient2(low = "white", mid = "lightblue", high = "darkred", name = "Alcohol Consumed (Litres)") + labs(title = "2015 Alcohol Consumption per Capita")


# selecting specific year 2018
extractedData2018 = filter(newExtractedData, Year == 2018)

extractedData2018Map = left_join(worldMap, extractedData2018, by = c("iso3c" = "Code"))

# heat map based on total alcohol consumption in 2018 
dataMap2018 = ggplot() + geom_map(data = extractedData2018Map, map = extractedData2018Map, aes(x = long, y = lat, map_id = region, fill = Total_alcohol_consumption_per_capita), color = "black") + coord_equal() + theme_void() + scale_fill_gradient2(low = "white", mid = "lightblue", high = "darkred", name = "Alcohol Consumed (Litres)") + labs(title = "2018 Alcohol Consumption per Capita")


# display graphs using par()
par(mfrow = c(3, 2))
plot(dataMap2000)
plot(dataMap2005)
plot(dataMap2010)
plot(dataMap2015)
plot(dataMap2018)

```

The heat maps present the data of alcohol consumption per capita in 2000, 2005, 2010, 2015 and 2018.  


